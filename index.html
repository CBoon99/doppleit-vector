<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cindara Vectorizer</title>
    <style>
        :root {
            --primary-color: #e37800;
            --glow-color: #ffb340;
            --gradient: linear-gradient(90deg, #e37800, #ffb340);
            --shadow-glow: 0 0 10px rgba(255, 191, 64, 0.4);
        }
        * {
            box-sizing: border-box;
        }
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(180deg, #1a1a1a 0%, #2a2a40 100%);
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        #header {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.08);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        #header h1 {
            font-size: 24px;
            font-weight: 700;
            margin: 0;
            text-shadow: var(--shadow-glow);
        }
        #status {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        #status::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #00ff00;
            border-radius: 50%;
            margin-right: 6px;
        }
        #toolbar {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            align-items: center;
        }
        .tool-btn, .export-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 8px;
            background: var(--gradient);
            color: #fff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .tool-btn:hover, .export-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-glow);
        }
        .tool-btn:active, .export-btn:active {
            transform: translateY(1px);
            box-shadow: none;
        }
        .tool-btn.active {
            background: #ffb340;
            box-shadow: var(--shadow-glow);
        }
        .tool-btn svg, .export-btn svg {
            width: 18px;
            height: 18px;
            fill: #fff;
        }
        .tool-btn:hover svg, .export-btn:hover svg {
            fill: #fff;
        }
        .divider {
            width: 1px;
            background: rgba(255, 255, 255, 0.2);
            align-self: stretch;
            margin: 0 8px;
        }
        #colorPicker {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }
        #colorCanvas {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            cursor: crosshair;
            clip-path: circle(40px at center);
            aspect-ratio: 1 / 1;
        }
        #lightnessSlider {
            width: 20px;
            height: 80px;
            border-radius: 4px;
            cursor: pointer;
        }
        #colorInputs {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        #colorInputs input {
            padding: 4px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 12px;
            width: 100px;
        }
        #swatches {
            display: flex;
            gap: 4px;
            margin-top: 8px;
        }
        .swatch {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .swatch:hover {
            transform: scale(1.1);
        }
        #toolOptions {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }
        #toolOptions h4 {
            margin: 0;
            font-size: 13px;
            font-weight: 600;
        }
        #toolOptions label {
            font-size: 12px;
            margin-right: 4px;
        }
        #toolOptions input, #toolOptions select {
            padding: 4px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 12px;
        }
        #exportOptions {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        #filenameInput {
            padding: 4px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 12px;
            width: 150px;
        }
        #canvasContainer {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            overflow: auto;
        }
        #canvas {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        #footer {
            padding: 10px;
            background: rgba(255, 255, 255, 0.08);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            text-align: center;
            font-size: 12px;
            color: #cccccc;
        }
        #footer a {
            color: var(--glow-color);
            text-decoration: none;
            margin: 0 10px;
        }
        #footer a:hover {
            text-decoration: underline;
        }
        .tooltip {
            position: relative;
        }
        .tooltip::after {
            content: attr(title);
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease-in-out;
            backdrop-filter: blur(10px);
        }
        .tooltip:hover::after {
            opacity: 1;
        }
        @media (min-width: 1024px) {
            #colorPicker {
                flex-direction: column;
                align-items: flex-start;
            }
            #colorInputs, #swatches {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        @media (max-width: 768px) {
            #header, #toolbar, #canvasContainer {
                padding: 12px;
            }
            #header h1 {
                font-size: 20px;
            }
            #colorCanvas, #lightnessSlider {
                width: 60px;
                height: 60px;
            }
            #colorInputs input {
                width: 80px;
            }
            #toolOptions {
                flex-wrap: wrap;
            }
            #filenameInput {
                width: 120px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="header">
            <h1>Cindara Vectorizer</h1>
            <div id="status">Online</div>
        </div>
        <div id="toolbar">
            <button class="tool-btn active tooltip" data-tool="pen" title="Pen Tool" aria-label="Pen Tool">
                <svg viewBox="0 0 24 24"><path d="M3 17v4h4l14-14-4-4z"/></svg>
                Pen
            </button>
            <button class="tool-btn tooltip" data-tool="shape" title="Shape Tool" aria-label="Shape Tool">
                <svg viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16"/></svg>
                Shape
            </button>
            <div class="divider"></div>
            <div id="colorPicker">
                <div style="display: flex; gap: 8px;">
                    <canvas id="colorCanvas" width="80" height="80"></canvas>
                    <canvas id="lightnessSlider" width="20" height="80"></canvas>
                </div>
                <div id="colorInputs">
                    <input id="hexInput" placeholder="HEX" aria-label="HEX Color Input">
                    <input id="hslInput" placeholder="HSL" aria-label="HSL Color Input">
                    <input id="rgbInput" placeholder="RGB" aria-label="RGB Color Input">
                </div>
                <div id="swatches"></div>
            </div>
            <div class="divider"></div>
            <div id="toolOptions">
                <h4>Tool Options</h4>
                <label for="strokeWidth">Stroke:</label>
                <input type="range" id="strokeWidth" min="1" max="50" value="5" aria-label="Stroke Width">
                <label for="opacity">Opacity:</label>
                <input type="range" id="opacity" min="0" max="1" step="0.1" value="1" aria-label="Opacity">
                <label for="fill">Fill:</label>
                <input type="checkbox" id="fill" aria-label="Fill Toggle">
                <label for="strokeStyle">Style:</label>
                <select id="strokeStyle" aria-label="Stroke Style">
                    <option value="solid">Solid</option>
                    <option value="dashed">Dashed</option>
                    <option value="dotted">Dotted</option>
                </select>
            </div>
            <div class="divider"></div>
            <div id="exportOptions">
                <input id="filenameInput" placeholder="project-name-date" aria-label="Export Filename">
                <button class="export-btn tooltip" id="exportSvg" title="Export as SVG" aria-label="Export as SVG">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5v18l7-3 7 3V3z"/></svg>
                    SVG
                </button>
                <button class="export-btn tooltip" id="exportPng" title="Export as PNG" aria-label="Export as PNG">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5v18l7-3 7 3V3z"/></svg>
                    PNG
                </button>
                <button class="export-btn tooltip" id="exportJpeg" title="Export as JPEG" aria-label="Export as JPEG">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5v18l7-3 7 3V3z"/></svg>
                    JPEG
                </button>
            </div>
        </div>
        <div id="canvasContainer">
            <canvas id="canvas" width="800" height="600"></canvas>
        </div>
        <div id="footer">
            <a href="#" aria-label="About Cindara">About</a> |
            <a href="#" aria-label="Support">Support</a> |
            Cindara Suite v1.0
        </div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const colorCanvas = document.getElementById('colorCanvas');
        const colorCtx = colorCanvas.getContext('2d');
        const lightnessSlider = document.getElementById('lightnessSlider');
        const lightnessCtx = lightnessSlider.getContext('2d');
        const hexInput = document.getElementById('hexInput');
        const hslInput = document.getElementById('hslInput');
        const rgbInput = document.getElementById('rgbInput');
        const swatches = document.getElementById('swatches');
        const strokeWidth = document.getElementById('strokeWidth');
        const opacity = document.getElementById('opacity');
        const fill = document.getElementById('fill');
        const strokeStyle = document.getElementById('strokeStyle');
        const filenameInput = document.getElementById('filenameInput');
        const exportSvg = document.getElementById('exportSvg');
        const exportPng = document.getElementById('exportPng');
        const exportJpeg = document.getElementById('exportJpeg');

        let currentTool = 'pen';
        let drawing = false;
        let paths = [];
        let currentPath = [];
        let currentColor = '#e37800';
        let currentLightness = 50;
        let swatchHistory = JSON.parse(localStorage.getItem('swatches')) || [];

        // Set Tool Cursors
        function updateCursor() {
            canvas.style.cursor = currentTool === 'pen' ? 'crosshair' : 'default';
        }
        updateCursor();

        // Color Picker
        function drawColorWheel() {
            const width = colorCanvas.width;
            const height = colorCanvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 2;

            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    const dx = x - centerX;
                    const dy = y - centerY;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    if (distance <= radius) {
                        const angle = Math.atan2(dy, dx);
                        const hue = (angle * 180 / Math.PI + 180) % 360;
                        const saturation = distance / radius;
                        const color = `hsl(${hue}, ${saturation * 100}%, ${currentLightness}%)`;
                        colorCtx.fillStyle = color;
                        colorCtx.fillRect(x, y, 1, 1);
                    }
                }
            }
        }

        function drawLightnessSlider() {
            const gradient = lightnessCtx.createLinearGradient(0, 0, 0, lightnessSlider.height);
            gradient.addColorStop(0, `hsl(0, 0%, 100%)`);
            gradient.addColorStop(1, `hsl(0, 0%, 0%)`);
            lightnessCtx.fillStyle = gradient;
            lightnessCtx.fillRect(0, 0, lightnessSlider.width, lightnessSlider.height);
        }

        function updateColorInputs(color) {
            const rgb = hexToRgb(color);
            const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
            hexInput.value = color;
            hslInput.value = `${Math.round(hsl.h)}, ${Math.round(hsl.s * 100)}%, ${Math.round(hsl.l * 100)}%`;
            rgbInput.value = `${rgb.r}, ${rgb.g}, ${rgb.b}`;
        }

        function addSwatch(color) {
            if (!swatchHistory.includes(color)) {
                swatchHistory.unshift(color);
                if (swatchHistory.length > 5) swatchHistory.pop();
                localStorage.setItem('swatches', JSON.stringify(swatchHistory));
                renderSwatches();
            }
        }

        function renderSwatches() {
            swatches.innerHTML = '';
            swatchHistory.forEach(color => {
                const swatch = document.createElement('div');
                swatch.className = 'swatch';
                swatch.style.background = color;
                swatch.addEventListener('click', () => {
                    currentColor = color;
                    updateColorInputs(color);
                    drawColorWheel();
                });
                swatches.appendChild(swatch);
            });
        }

        colorCanvas.addEventListener('click', e => {
            const rect = colorCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const imageData = colorCtx.getImageData(x, y, 1, 1).data;
            const color = rgbToHex(imageData[0], imageData[1], imageData[2]);
            currentColor = color;
            updateColorInputs(color);
            addSwatch(color);
        });

        lightnessSlider.addEventListener('click', e => {
            const rect = lightnessSlider.getBoundingClientRect();
            const y = e.clientY - rect.top;
            currentLightness = (1 - y / lightnessSlider.height) * 100;
            drawColorWheel();
            const imageData = colorCtx.getImageData(colorCanvas.width / 2, colorCanvas.height / 2, 1, 1).data;
            const color = rgbToHex(imageData[0], imageData[1], imageData[2]);
            currentColor = color;
            updateColorInputs(color);
            addSwatch(color);
        });

        hexInput.addEventListener('input', e => {
            if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
                currentColor = e.target.value;
                updateColorInputs(currentColor);
                addSwatch(currentColor);
                drawColorWheel();
            }
        });

        // Drawing
        function startDrawing(e) {
            drawing = true;
            currentPath = [];
            const pos = getCanvasPosition(e);
            currentPath.push(pos);
        }

        function draw(e) {
            if (!drawing) return;
            const pos = getCanvasPosition(e);
            currentPath.push(pos);
            redrawCanvas();
        }

        function stopDrawing() {
            if (drawing) {
                drawing = false;
                paths.push({
                    tool: currentTool,
                    points: currentPath,
                    color: currentColor,
                    strokeWidth: strokeWidth.value,
                    opacity: opacity.value,
                    fill: fill.checked,
                    strokeStyle: strokeStyle.value
                });
                currentPath = [];
            }
        }

        function getCanvasPosition(e) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }

        function redrawCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            paths.forEach(path => {
                ctx.beginPath();
                ctx.strokeStyle = path.color;
                ctx.lineWidth = path.strokeWidth;
                ctx.globalAlpha = path.opacity;
                if (path.strokeStyle === 'dashed') ctx.setLineDash([5, 5]);
                else if (path.strokeStyle === 'dotted') ctx.setLineDash([2, 8]);
                else ctx.setLineDash([]);
                if (path.tool === 'pen') {
                    path.points.forEach((point, i) => {
                        if (i === 0) ctx.moveTo(point.x, point.y);
                        else ctx.lineTo(point.x, point.y);
                    });
                    ctx.stroke();
                } else if (path.tool === 'shape') {
                    const [start, end] = path.points;
                    ctx.rect(start.x, start.y, end.x - start.x, end.y - start.y);
                    if (path.fill) {
                        ctx.fillStyle = path.color;
                        ctx.fill();
                    }
                    ctx.stroke();
                }
                ctx.globalAlpha = 1;
                ctx.setLineDash([]);
            });
            if (currentPath.length > 0) {
                ctx.beginPath();
                ctx.strokeStyle = currentColor;
                ctx.lineWidth = strokeWidth.value;
                ctx.globalAlpha = opacity.value;
                if (strokeStyle.value === 'dashed') ctx.setLineDash([5, 5]);
                else if (strokeStyle.value === 'dotted') ctx.setLineDash([2, 8]);
                else ctx.setLineDash([]);
                currentPath.forEach((point, i) => {
                    if (i === 0) ctx.moveTo(point.x, point.y);
                    else ctx.lineTo(point.x, point.y);
                });
                ctx.stroke();
                ctx.globalAlpha = 1;
                ctx.setLineDash([]);
            }
        }

        // Export
        function exportCanvas(format) {
            const defaultName = `project-${new Date().toISOString().split('T')[0]}`;
            const filename = filenameInput.value || defaultName;
            const fullFilename = `${filename}.${format}`;
            if (format === 'svg') {
                let svg = `<svg width="${canvas.width}" height="${canvas.height}" xmlns="http://www.w3.org/2000/svg">`;
                paths.forEach(path => {
                    let d = '';
                    if (path.tool === 'pen') {
                        d = path.points.map((p, i) => `${i === 0 ? 'M' : 'L'}${p.x},${p.y}`).join(' ');
                        svg += `<path d="${d}" stroke="${path.color}" stroke-width="${path.strokeWidth}" opacity="${path.opacity}" fill="none" stroke-dasharray="${path.strokeStyle === 'dashed' ? '5,5' : path.strokeStyle === 'dotted' ? '2,8' : ''}"/>`;
                    } else if (path.tool === 'shape') {
                        const [start, end] = path.points;
                        svg += `<rect x="${start.x}" y="${start.y}" width="${end.x - start.x}" height="${end.y - start.y}" stroke="${path.color}" stroke-width="${path.strokeWidth}" opacity="${path.opacity}" fill="${path.fill ? path.color : 'none'}" stroke-dasharray="${path.strokeStyle === 'dashed' ? '5,5' : path.strokeStyle === 'dotted' ? '2,8' : ''}"/>`;
                    }
                });
                svg += '</svg>';
                const blob = new Blob([svg], { type: 'image/svg+xml' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fullFilename;
                a.click();
                URL.revokeObjectURL(url);
            } else {
                const url = canvas.toDataURL(`image/${format}`);
                const a = document.createElement('a');
                a.href = url;
                a.download = fullFilename;
                a.click();
            }
        }

        // Color Conversion Utilities
        function hexToRgb(hex) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return { r, g, b };
        }

        function rgbToHex(r, g, b) {
            return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;
        }

        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            return { h: h * 360, s, l };
        }

        // Event Listeners
        document.querySelectorAll('.tool-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentTool = btn.dataset.tool;
                updateCursor();
            });
        });

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseleave', stopDrawing);

        exportSvg.addEventListener('click', () => exportCanvas('svg'));
        exportPng.addEventListener('click', () => exportCanvas('png'));
        exportJpeg.addEventListener('click', () => exportCanvas('jpeg'));

        // Keyboard Shortcuts
        document.addEventListener('keydown', e => {
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                exportCanvas('svg');
            } else if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                paths.pop();
                redrawCanvas();
            } else if (e.key === 'p' || e.key === 'P') {
                document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('[data-tool="pen"]').classList.add('active');
                currentTool = 'pen';
                updateCursor();
            } else if (e.key === 'r' || e.key === 'R') {
                document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('[data-tool="shape"]').classList.add('active');
                currentTool = 'shape';
                updateCursor();
            }
        });

        // Initialize
        filenameInput.value = `project-${new Date().toISOString().split('T')[0]}`;
        drawColorWheel();
        drawLightnessSlider();
        updateColorInputs(currentColor);
        renderSwatches();
    </script>
</body>
</html>